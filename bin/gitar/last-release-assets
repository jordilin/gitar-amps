#!/bin/sh

# Select the last stable release.

last_release_id=$(gr rl list -r --repo "$1" --page=1 --format json | jq -c 'select(.Prerelease == "false")' | tail -n 1 | jq -r '.ID')

if [ -z "$last_release_id" ]; then
    echo "No release found"
    exit 1
fi

# gather the assets for this release ID

assets=$(gr rl assets list --repo "$1" "$last_release_id" --format json)
if [ "$assets" = "No resources found." ]; then
    echo "No assets found"
    exit 1
else
    echo "$assets" | jq -r '[.URL] | @csv' | sed 's/"//g'
fi
